<?xml version="1.0" encoding="UTF-8"?>
<html>
 <head>
  <title>Protorabbit Monitor</title>
<script type="text/javascript" src="resources/jmaki/jmaki-full.js"></script>
<script type="text/javascript" src="resources/js/monitor.js"></script>
<script>
jmaki.config =  {
    forceActiveXXHR : true,
    logLevel : 'off'
}

jmaki.subscribe("/jmaki/extensions/widgetFactory/loadComplete", function() {
    jmaki.getWidget("realtimeStats").setValue(

            {"data":[

//{"lines":{"color":null,"barWidth":null,"show":false,"stacked":false},"yaxis":2,"label":"Satisfied","values":[{"time":1235959200000,"y":20},{"time":1235962800000,"y":50},{"time":1235966400000,"y":25},{"time":1235970000000,"y":22},{"time":1235973600000,"y":52},{"time":1235977200000,"y":26},{"time":1235980800000,"y":23},{"time":1235984400000,"y":51},{"time":1235988000000,"y":15},{"time":1235991600000,"y":26},{"time":1235995200000,"y":16},{"time":1235998800000,"y":54},{"time":1236002400000,"y":32},{"time":1236006000000,"y":21},{"time":1236009600000,"y":66},{"time":1236013200000,"y":35},{"time":1236016800000,"y":34},{"time":1236020400000,"y":53},{"time":1236024000000,"y":30},{"time":1236027600000,"y":24},{"time":1236031200000,"y":52},{"time":1236034800000,"y":35},{"time":1236038400000,"y":40}],"bars":{"color":null,"barWidth":"hour","show":true,"stacked":true},"id":"satisfied","points":null},{"lines":{"color":null,"barWidth":null,"show":false,"stacked":false},"yaxis":2,"label":"Unsatisfied with Service","values":[{"time":1235959200000,"y":10},{"time":1235962800000,"y":5},{"time":1235966400000,"y":6},{"time":1235970000000,"y":2},{"time":1235973600000,"y":4},{"time":1235977200000,"y":5},{"time":1235980800000,"y":6},{"time":1235984400000,"y":12},{"time":1235988000000,"y":4},{"time":1235991600000,"y":5},{"time":1235995200000,"y":15},{"time":1235998800000,"y":15},{"time":1236002400000,"y":21},{"time":1236006000000,"y":9},{"time":1236009600000,"y":11},{"time":1236013200000,"y":4},{"time":1236016800000,"y":10},{"time":1236020400000,"y":1},{"time":1236024000000,"y":8},{"time":1236027600000,"y":6},{"time":1236031200000,"y":6},{"time":1236034800000,"y":7},{"time":1236038400000,"y":2}],"bars":

//{"color":null,"barWidth":"hour","show":true,"stacked":true},"id":"unsatisfied-service","points":null},{"lines":{"color":null,"barWidth":null,"show":false,"stacked":false},"yaxis":2,"label":"Unsatisfied with Agent","values":[{"time":1235959200000,"y":3},{"time":1235962800000,"y":2},{"time":1235966400000,"y":1},{"time":1235970000000,"y":4},{"time":1235973600000,"y":4},{"time":1235977200000,"y":5},{"time":1235980800000,"y":3},{"time":1235984400000,"y":2},{"time":1235988000000,"y":6},{"time":1235991600000,"y":19},{"time":1235995200000,"y":15},{"time":1235998800000,"y":22},{"time":1236002400000,"y":24},{"time":1236006000000,"y":16},{"time":1236009600000,"y":10},{"time":1236013200000,"y":3},{"time":1236016800000,"y":5},{"time":1236020400000,"y":3},{"time":1236024000000,"y":4},{"time":1236027600000,"y":6},{"time":1236031200000,"y":2},{"time":1236034800000,"y":3},{"time":1236038400000,"y":5}],"bars":{"color":null,"barWidth":"hour","show":true,"stacked":true},"id":"unsatisfied-rep","points":null},

//{"lines":{"color":null,"barWidth":null,"show":false,"stacked":false},"yaxis":2,"label":"Unsatisfied with Agent and Service","values":[{"time":1235959200000,"y":4},{"time":1235962800000,"y":1},{"time":1235966400000,"y":7},{"time":1235970000000,"y":5},{"time":1235973600000,"y":1},{"time":1235977200000,"y":0},{"time":1235980800000,"y":0},{"time":1235984400000,"y":1},{"time":1235988000000,"y":0},{"time":1235991600000,"y":1},{"time":1235995200000,"y":4},{"time":1235998800000,"y":2},{"time":1236002400000,"y":4},{"time":1236006000000,"y":11},{"time":1236009600000,"y":4},{"time":1236013200000,"y":6},{"time":1236016800000,"y":6},{"time":1236020400000,"y":5},{"time":1236024000000,"y":6},{"time":1236027600000,"y":9},{"time":1236031200000,"y":7},{"time":1236034800000,"y":7},{"time":1236038400000,"y":7}],"bars":{"color":null,"barWidth":"hour","show":true,"stacked":true},"id":"unsatisfied-rep-and-service","points":null},

{"lines":null,"yaxis":1,"label":"Satisfaction Percentage","values":[{"time":1235959200000,"y":85.44},{"time":1235962800000,"y":87.22},{"time":1235966400000,"y":86.22},{"time":1235970000000,"y":83.22},{"time":1235973600000,"y":85.82},{"time":1235977200000,"y":84.22},{"time":1235980800000,"y":80.12},{"time":1235984400000,"y":79.12},{"time":1235988000000,"y":77.12},{"time":1235991600000,"y":75.11},{"time":1235995200000,"y":72.50},{"time":1235998800000,"y":71.33},{"time":1236002400000,"y":67.22},{"time":1236006000000,"y":65.22},{"time":1236009600000,"y":70.12},{"time":1236013200000,"y":75.12},{"time":1236016800000,"y":73.11},{"time":1236020400000,"y":74.12},{"time":1236024000000,"y":80.12},{"time":1236027600000,"y":81.91},{"time":1236031200000,"y":85.12},{"time":1236034800000,"y":88.11},{"time":1236038400000,"y":89.51}],"bars":null,"id":"satisfaction_percentage","points":{"color":null,"barWidth":null,"show":true,"stacked":false}}],}

    );
    loadStats();
   // console.log( roundToSecond(45020) );
   // console.log( roundToSecond(45020) );
   // console.log( roundToSecond(45150) );
   // console.log( roundToSecond(46020) );
});
</script>

<style>

.pmenu {
  padding:3px;
  height:40px;
  font-size:2em;
  background:#333;
  color:#fff
}

.pmenu a {
  color : #fff;
  font-size:0.4em;
}

.pmenu a:visited {
  color : #fff;
}

.blockTable {
  background : #eee;
  border : 1px solid #333;
  width : 100%;
  font-size : .8em;
  overflow : hidden;
}

.blockTable td {
  background : #fff;
}
</style>

<script>

</script>
 </head>
 <body>
  <div class="pmenu">
   <div style="float:left">Protorabbit Resources</div>
    <div style="float:right">
    <a href="episodes.html">Episodes</a>
    <a href="components.html">Components</a>
    <a href="resources.html">Resources</a>
    <a href="statistics.html">  Statistics</a>
    <a href="../"> Home</a>
   </div>
  </div>
  <div id="body" style="padding:15px">
  
  <div style="float:left;width:255px"> 
  <div style="padding-top:10px;text-align:center;font-size:1.2em">Pages (text/html)</div>
  <div jmakiId="views" jmakiName="jmaki.charting.pie"
       jmakiArgs="{ legend : { targetId : 'dispoLegend',
                    labelFormatter : function(contents,value, x,y) {
                    return contents + '&nbsp;(' + (value.data) + ')';
                  }
                  }, showHoverLabels : false }"
       style="height:250px"></div>
   <div id="dispoLegend" style="clear:left;float:left"></div>
  
   <div style="clear:both;height:5px"></div>
   
   <div id="totalResources" style="text-align:center;clear:both"></div>

   <div style="clear:both;height:15px"></div>

   <div style="text-align:center;font-size:1.2em">Hops (application/json)</div>
  <div jmakiId="actions" jmakiName="jmaki.charting.pie"
       jmakiArgs="{ legend : { targetId : 'topResourcesLegend',
                    labelFormatter : function(contents,value, x,y) {
                    return contents + '&nbsp;(' + value.data + ')';
                  }
                  }, showHoverLabels : false }"
       style="height:250px"></div>   
   <div id="topResourcesLegend" style="clear:left;float:left"></div>
  </div>

  <div style="margin-top:5px;margin-left:265px">
    <div style="height:300px;border:1px solid #333" id="realtimeChart">
         <div jmakiName="jmaki.charting.line" jmakiId="realtimeStats" style="height:100%"
              jmakiArgs="{
                    legend : {
                       targetId : 'legend',
                       noColumns : 2
                    },
                    colors : [ '#4da74d', '#EB5E66',  '#D41A1F', '#AF1E2D', '#9E0508','#E31230' ],
                    showHoverLabels : true,
                    hoverFormatter : function(m){
                        if (m.value.x) {
                            return 'Volume ' + m.value.y + ' ' + new Date(m.value.x);
                        } else {
                            return m.value;
                        }
                    },
                    xAxis : {
                       mode : 'time',
                       timeUnit : 'hour',
                       title : 'Hour'
                    },
                    yAxis : {
                     title : 'Requests' ,
                     rotate : true,
                     tickFormatter : function(val) {
                         return val.toFixed(0);
                       }                     
                    },
                    y2Axis : {
                      rotate : true,
                      min : 0,
                    }

                   }"
               ></div>

    </div>
    <div style="height:400px;overflow-y:auto;border:1px solid #333;padding:3px" id="bodyContent"></div>
    <div><span>
     <select id="timespan" onchange="loadPageViews()">
       <option value="60">Last Minute</option>
       <option value="300">Last 5 Minutes</option>
       <option value="600">Last 10 Minutes</option>
       <option value="3600">Last Hour</option>
     </select>
    </span><span><input type="button" onclick="loadPageViews()" value="Refresh"/></span><span>&nbsp;&nbsp;</span><span id="status"></span></div>
  </div>
  </div>
 </body>
</html>